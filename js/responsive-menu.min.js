(function(root,factory){if(typeof define==='function'&&define.amd){define('responsivemenu',factory(root))}else if(typeof exports==='object'){module.responsivemenu=factory(root)}else{root.responsivemenu=factory(root)}})(this,function(root){'use strict';var exports={};var supports=!!document.querySelector&&!!root.addEventListener;var settings;var menu;var hasChildren=!1;var subtoggles=!1;var defaults={menu:'',initiated_class:'rm-initiated',before_element:'',toggletype:'button',toggleclass:'rm-togglebutton',toggleclosedclass:'rm-togglebutton--closed',togglecontent:'<i class="fa fa-bars" aria-hidden="true"></i>',subtoggletype:'button',subtoggleclass:'rm-subtoggle',subtogglecontent:'<i class="fa fa-caret-down" aria-hidden="true"></i>',sticky:0,absolute:0,hideclass:'rm-closed',openclass:'rm-opened',openbodyclass:'has-opened-menu',focusedclass:'rm-focused',animateopenclass:'is-opening',animatecloseclass:'is-closing',animateduration:0,subanimateopenclass:'is-opening',subanimatecloseclass:'is-closing',subanimateduration:0,parentclass:'rm-parent',fullmenuclass:'rm-fullmenu',absolutemenuclass:'rm-absolutemenu',bodyoverflowhiddenclass:'rm-bodyoverflowhidden',menuoverflowautoclass:'rm-menuoverflowauto',stickyclass:'rm-sticky',stickyinitiatedclass:'rm-sticky-initiated',noresponsivemenuclass:'rm-no-responsive-menu',mobileindicatorid:'rm-mobile-indicator',onAfterInit:function(){},onBeforeToggleOpen:function(){},onAfterToggleOpen:function(){},onBeforeToggleClose:function(){},onAfterToggleClose:function(){},onBeforeSubToggleOpen:function(){},onAfterSubToggleOpen:function(){},onBeforeSubToggleClose:function(){},onAfterSubToggleClose:function(){}};var forEach=function(collection,callback,scope){if(Object.prototype.toString.call(collection)==='[object Object]'){for(var prop in collection){if(Object.prototype.hasOwnProperty.call(collection,prop)){callback.call(scope,collection[prop],prop,collection)}}}else{for(var i=0,len=collection.length;i<len;i++){callback.call(scope,collection[i],i,collection)}}};var extend=function(defaults,options){var extended={};forEach(defaults,function(value,prop){extended[prop]=defaults[prop]});forEach(options,function(value,prop){extended[prop]=options[prop]});return extended};var trim=function(string){return string.replace(/^\s+|\s+$/g,'')};var getDataOptions=function(options){var settings={};if(options){options=options.split(';');options.forEach(function(option){option=trim(option);if(option!==''){option=option.split(':');settings[option[0]]=trim(option[1])}})}
return settings};var waitForFinalEvent=(function(){var timers={};return function(callback,ms,uniqueId){if(!uniqueId){uniqueId="Don't call this twice without a uniqueId"}
if(timers[uniqueId]){clearTimeout(timers[uniqueId])}
timers[uniqueId]=setTimeout(callback,ms)}})();function getParents(element,tag,stop){var nodes=[];while(element.parentNode&&element.parentNode!=stop){element=element.parentNode;if(element.tagName==tag){nodes.push(element)}}
return nodes}
function getStyle(el,styleProp)
{var x=document.getElementById(el);if(window.getComputedStyle)
{var y=document.defaultView.getComputedStyle(x,null).getPropertyValue(styleProp)}
else if(x.currentStyle)
{var y=x.currentStyle[styleProp]}
return y}
function initialize(settings){if(settings.menu==''){menu=settings.wrapper.getElementsByTagName('ul')[0]}else{menu=settings.menu}
apollo.addClass(settings.wrapper,settings.initiated_class);settings.onAfterInit();var parents=menu.querySelectorAll('li ul');if(parents.length){hasChildren=!0;subtoggles=document.getElementsByClassName(settings.subtoggleclass)}
var mobileindicator=document.createElement('div');document.body.appendChild(mobileindicator);mobileindicator.id=settings.mobileindicatorid;var mobileindicatorZindex=0;var toggle_element=document.createElement(settings.toggletype);apollo.addClass(toggle_element,[settings.toggleclass,settings.hideclass]);if(settings.before_element==''){settings.before_element=settings.wrapper.firstChild}
settings.before_element.parentNode.insertBefore(toggle_element,settings.before_element);var togglebutton=document.getElementsByClassName(settings.toggleclass)[0];togglebutton.innerHTML=settings.togglecontent;togglebutton.setAttribute('aria-hidden','true');togglebutton.setAttribute('aria-pressed','false');togglebutton.setAttribute('type','button');if(hasChildren){for(var i=0;i<parents.length;i++){var subtoggle_element=document.createElement(settings.subtoggletype);apollo.addClass(subtoggle_element,[settings.subtoggleclass,settings.hideclass]);var parent=parents[i].parentNode;parent.insertBefore(subtoggle_element,parent.firstChild);subtoggle_element.innerHTML=settings.subtogglecontent;subtoggle_element.setAttribute('aria-hidden','true');subtoggle_element.setAttribute('aria-pressed','false');subtoggle_element.setAttribute('type','button');apollo.addClass(parents[i].parentNode,settings.parentclass)}}
function classes(){mobileindicatorZindex=getStyle(settings.mobileindicatorid,"z-index");if(mobileindicatorZindex==0&&!apollo.hasClass(menu,settings.openclass)){apollo.removeClass(togglebutton,settings.hideclass);if(hasChildren){forEach(subtoggles,function(value,prop){apollo.addClass(subtoggles[prop].parentNode.getElementsByTagName('ul')[0],settings.hideclass);apollo.removeClass(subtoggles[prop],settings.hideclass)})}
apollo.removeClass(menu,[settings.openclass,settings.fullmenuclass]);apollo.addClass(menu,settings.hideclass);apollo.removeClass(document.body,settings.openbodyclass);if(settings.absolute==1){apollo.addClass(menu,settings.absolutemenuclass)}}else if(mobileindicatorZindex==1){apollo.addClass(togglebutton,settings.hideclass);apollo.removeClass(togglebutton,settings.toggleclosedclass);if(hasChildren){forEach(subtoggles,function(value,prop){apollo.removeClass(subtoggles[prop].parentNode.getElementsByTagName('ul')[0],settings.hideclass);apollo.addClass(subtoggles[prop],settings.hideclass)})}
apollo.removeClass(menu,[settings.openclass,settings.hideclass]);apollo.addClass(menu,settings.fullmenuclass);apollo.removeClass(document.body,settings.openbodyclass);if(settings.absolute==1&&apollo.hasClass(menu,settings.absolutemenuclass)){apollo.removeClass(menu,settings.absolutemenuclass)}}}
function stickyMenu(){if(settings.sticky==1){var menuheight=settings.wrapper.offsetHeight;var viewportheight=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(viewportheight<=menuheight&&!apollo.hasClass(document.body,settings.bodyoverflowhiddenclass)){apollo.addClass(document.body,settings.bodyoverflowhiddenclass);apollo.addClass(settings.wrapper,settings.menuoverflowautoclass)}else if(viewportheight>menuheight){if(apollo.hasClass(document.body,settings.bodyoverflowhiddenclass)){apollo.removeClass(document.body,settings.bodyoverflowhiddenclass);apollo.removeClass(settings.wrapper,settings.menuoverflowautoclass)}
if(!apollo.hasClass(settings.wrapper,settings.stickyclass)){apollo.addClass(settings.wrapper,settings.stickyclass)}
if(!apollo.hasClass(menu,settings.openclass)&&!apollo.hasClass(document.body,settings.stickyinitiatedclass)){var paddingtop=menuheight.toString()+'px';document.body.setAttribute('style','padding-top:'+paddingtop);apollo.addClass(document.body,settings.stickyinitiatedclass)}}}}
window.addEventListener('load',function(){classes();stickyMenu()},!0);window.addEventListener('resize',function(){classes();stickyMenu();waitForFinalEvent(function(){classes();stickyMenu()},200)},!0);var menulinks=menu.getElementsByTagName('a');for(var i=0;i<menulinks.length;i++){menulinks[i].onblur=function(){var focusedItems=document.getElementsByClassName('rm-focused');for(var f=0;f<focusedItems.length;f++){apollo.removeClass(focusedItems[f],settings.focusedclass)}};menulinks[i].onfocus=function(){var siblings=this.parentNode.parentNode.querySelectorAll('li');if(siblings.length){for(var f=0;f<siblings.length;f++){apollo.removeClass(siblings[f],settings.focusedclass)}}
var parent=getParents(this,"LI",menu);if(parent.length){for(var f=0;f<parent.length;f++){apollo.addClass(parent[f],settings.focusedclass)}}}}
window.addEventListener('load',function(){if(apollo.hasClass(menu,settings.hideclass)){settings.onBeforeToggleOpen();apollo.removeClass(menu,settings.hideclass);apollo.addClass(menu,settings.openclass);apollo.addClass(document.body,settings.openbodyclass);apollo.addClass(togglebutton,settings.toggleclosedclass);apollo.addClass(menu,settings.animateopenclass);setTimeout(function(){apollo.removeClass(menu,settings.animateopenclass);settings.onAfterToggleOpen()},settings.animateduration)}
else if(apollo.hasClass(menu,settings.openclass)){settings.onBeforeToggleClose();apollo.addClass(menu,settings.animatecloseclass);apollo.removeClass(togglebutton,settings.toggleclosedclass);setTimeout(function(){apollo.removeClass(menu,settings.animatecloseclass);apollo.removeClass(menu,settings.openclass);apollo.addClass(menu,settings.hideclass);apollo.removeClass(document.body,settings.openbodyclass);settings.onAfterToggleClose()},settings.animateduration)}
stickyMenu();return!1});if(hasChildren){forEach(subtoggles,function(value,prop){var subtoggle=subtoggles[prop];var submenu=subtoggle.parentNode.getElementsByTagName('ul')[0];subtoggle.onclick=function(){if(apollo.hasClass(submenu,settings.hideclass)){settings.onBeforeSubToggleOpen();apollo.addClass(menu,settings.subanimateopenclass);apollo.addClass(subtoggle,settings.toggleclosedclass);apollo.removeClass(submenu,settings.hideclass);setTimeout(function(){apollo.removeClass(menu,settings.subanimateopenclass);settings.onAfterSubToggleOpen()},settings.subanimateduration)}
else if(!apollo.hasClass(submenu,settings.hideclass)){settings.onBeforeSubToggleClose();apollo.addClass(menu,settings.subanimatecloseclass);apollo.removeClass(subtoggle,settings.toggleclosedclass);setTimeout(function(){apollo.removeClass(menu,settings.subanimatecloseclass);apollo.addClass(submenu,settings.hideclass);settings.onAfterSubToggleClose()},settings.subanimateduration)}
stickyMenu()}})}}
exports.init=function(options){if(!supports){document.documentElement.className+=' '+settings.noresponsivemenuclass;return}
settings=extend(defaults,options||{});initialize(settings)};return exports})
